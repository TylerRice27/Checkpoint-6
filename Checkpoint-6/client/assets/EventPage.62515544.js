import{h as T,A,H as D,c as m,a as k,o as a,b as c,d as e,y as v,t as _,i as u,k as w,F as b,G as g,j as B,v as j,p as P,l as V,I as E,f as h}from"./vendor.8af76252.js";import{_ as N,c as p,P as l,l as y,A as r,t as f,b as C}from"./index.0d5cbcb5.js";const F={name:"EventPage",setup(){const i=T({eventId:""}),n=A();return D(async()=>{try{n.params.id&&(r.comments=[],await p.getComments(n.params.id),await C.getEvent(n.params.id),await f.getTicketsByEvent(n.params.id),i.value.eventId=n.params.id)}catch(o){l.toast(o)}}),{editable:i,towerEvent:m(()=>r.activeEvent),tickets:m(()=>r.tickets),account:m(()=>r.account),comments:m(()=>r.comments),isAttending:m(()=>r.tickets.find(o=>r.activeEvent.id==o.eventId)),async createComment(){try{i.value.eventId=n.params.id,await p.createComment(i.value)}catch(o){l.toast(o.message),y.error(o)}},async createTicket(){try{if(r.account.id){const o={accountId:r.account.id,eventId:n.params.id};await f.createTicket(o),this.towerEvent.capacity--,l.toast("Enjoy the Event","success")}else{l.toast("You must login to buy a ticket","info");return}}catch(o){l.toast(o.message),y.error(o)}},async cancelEvent(){try{const o=await C.cancelEvent(n.params.id)}catch(o){l.toast(o.message),y.error(o)}},formatDate(o){return` ${new Date(o).toDateString()}`}}}},d=i=>(P("data-v-54b2c249"),i=i(),V(),i),L={class:"event-page card bg-dark m-3"},M={class:"d-flex m-3 row",id:"towerEvent"},O=["src"],U={class:"m-3 col-md-4"},W={key:0,class:"bg-danger rounded col-md-3"},Y=d(()=>e("h6",null,"Cancelled!",-1)),G=[Y],H={key:1,class:"bg-danger rounded col-md-3"},R=d(()=>e("h6",null,"Sold Out!",-1)),q=[R],z={class:"text-warning"},J={key:2,class:"p-1"},K={class:"mt-5"},Q={class:"mt-5 pt-3"},X={key:3,class:"btn btn-danger mt-5",disabled:""},Z=h(" Canceled "),$=d(()=>e("i",{class:"mdi mdi-thumb-down"},null,-1)),tt=[Z,$],et={key:4,class:"btn btn-primary mt-5",disabled:""},ot=h(" Sold Out "),nt=d(()=>e("i",{class:"mdi mdi-thumb-up"},null,-1)),st=[ot,nt],at={key:5,class:"btn btn-warning mt-5",disabled:""},ct=h(" Already Attending "),it=d(()=>e("i",{class:"mdi mdi-thumb-up"},null,-1)),rt=[ct,it],dt=h(" Attend "),lt=d(()=>e("i",{class:"mdi mdi-thumb-up"},null,-1)),mt=[dt,lt],_t=d(()=>e("p",{class:"m-3 text-white"},"Who is Attending",-1)),vt={class:"col-md-12 card bg-dark"},ht={class:"row m-4 justify-content-center"},ut=d(()=>e("h3",{class:"text-center m-2"},"Create a Comment!",-1)),bt=d(()=>e("div",{class:"justify-content-end"},[e("button",{class:"btn btn-primary mt-2"},"Create!")],-1));function yt(i,n,o,t,x,kt){const S=k("Ticket"),I=k("Comment");return a(),c(b,null,[e("div",L,[e("section",M,[e("img",{class:"tower-pic img-fluid",src:t.towerEvent.coverImg,alt:""},null,8,O),e("div",U,[t.towerEvent.isCanceled==!0?(a(),c("div",W,G)):v("",!0),t.towerEvent.capacity==0?(a(),c("div",H,q)):v("",!0),e("h4",null,_(t.towerEvent.name),1),e("h5",z,_(t.towerEvent.location),1),t.towerEvent.startDate?(a(),c("h6",J," Event Date: "+_(t.formatDate(t.towerEvent.startDate)),1)):v("",!0),e("p",K,_(t.towerEvent.description),1),e("h3",Q,_(t.towerEvent.capacity)+" Spots Left",1),t.towerEvent.isCanceled?(a(),c("button",X,tt)):t.towerEvent.capacity==0?(a(),c("button",et,st)):t.isAttending?(a(),c("button",at,rt)):(a(),c("button",{key:6,class:"btn btn-primary mt-5",onClick:n[0]||(n[0]=(...s)=>t.createTicket&&t.createTicket(...s))},mt)),u(e("button",{class:"btn btn-danger mt-5 ms-5",onClick:n[1]||(n[1]=(...s)=>t.cancelEvent&&t.cancelEvent(...s))}," Cancel Event ",512),[[w,t.towerEvent.creatorId==t.account.id]])])])]),_t,u(e("div",vt,[(a(!0),c(b,null,g(t.tickets,s=>(a(),E(S,{key:s.id,ticket:s},null,8,["ticket"]))),128))],512),[[w,t.tickets]]),e("div",ht,[t.account.id?(a(),c("form",{key:0,class:"pb-4 d-flex rounded flex-column bg-dark col-md-8",onSubmit:n[3]||(n[3]=B((...s)=>t.createComment&&t.createComment(...s),["prevent"]))},[ut,u(e("textarea",{name:"commentBody",id:"commentBody",cols:"30",rows:"4",placeholder:"Tell Us What You Think!","onUpdate:modelValue":n[2]||(n[2]=s=>t.editable.body=s)},`
      `,512),[[j,t.editable.body]]),bt],32)):v("",!0),(a(!0),c(b,null,g(t.comments,s=>(a(),E(I,{class:"mt-4",key:s.id,comment:s},null,8,["comment"]))),128))])],64)}var Et=N(F,[["render",yt],["__scopeId","data-v-54b2c249"]]);export{Et as default};
